<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: GemChecksums
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "GemChecksums";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (G)</a> &raquo;
    
    
    <span class="title">GemChecksums</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: GemChecksums
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/gem_checksums.rb<span class="defines">,<br />
  lib/gem_checksums/version.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Semantic version for the GemChecksums namespace</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="GemChecksums/Version.html" title="GemChecksums::Version (module)">Version</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="GemChecksums/Error.html" title="GemChecksums::Error (class)">Error</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VERSION_REGEX-constant" class="">VERSION_REGEX =
          <div class="docstring">
  <div class="discussion">
    <p>Final clause of Regex <code>(?=\.gem)</code> is a positive lookahead assertion<br />
See: https://learnbyexample.github.io/Ruby_Regexp/lookarounds.html#positive-lookarounds<br />
Used to pattern match against a gem package name, which always ends with .gem.<br />
The positive lookahead ensures it is present, and prevents it from being captured.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>((\d+\.\d+\.\d+)([-.][0-9A-Za-z-]+)*)(?=\.gem)</span><span class='regexp_end'>/</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="RUNNING_AS-constant" class="">RUNNING_AS =
          
        </dt>
        <dd><pre class="code"><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='gvar'>$PROGRAM_NAME</span><span class='rparen'>)</span></pre></dd>
      
        <dt id="BUILD_TIME_ERROR_MESSAGE-constant" class="">BUILD_TIME_ERROR_MESSAGE =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Environment variable SOURCE_DATE_EPOCH must be set. You&#39;ll need to rebuild the gem. See README.md of stone_checksums</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="GIT_DRY_RUN_ENV-constant" class="">GIT_DRY_RUN_ENV =
          
        </dt>
        <dd><pre class="code"><span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GEM_CHECKSUMS_GIT_DRY_RUN</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>false</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_casecmp'>casecmp</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>true</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span></pre></dd>
      
        <dt id="CHECKSUMS_DIR-constant" class="">CHECKSUMS_DIR =
          
        </dt>
        <dd><pre class="code"><span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GEM_CHECKSUMS_CHECKSUMS_DIR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>checksums</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></pre></dd>
      
        <dt id="PACKAGE_DIR-constant" class="">PACKAGE_DIR =
          
        </dt>
        <dd><pre class="code"><span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GEM_CHECKSUMS_PACKAGE_DIR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pkg</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></pre></dd>
      
        <dt id="BUILD_TIME_WARNING-constant" class="">BUILD_TIME_WARNING =
          
        </dt>
        <dd><pre class="code"><span class='heredoc_beg'>&lt;&lt;~BUILD_TIME_WARNING</span>
<span class='tstring_content'>  WARNING: Build time not provided via environment variable SOURCE_DATE_EPOCH.
</span><span class='tstring_content'>           When using Bundler &lt; 2.7.0, you must set SOURCE_DATE_EPOCH *before* building
</span><span class='tstring_content'>           the gem to ensure consistent SHA-256 &amp; SHA-512 checksums.
</span><span class='tstring_content'>  
</span><span class='tstring_content'>  PREFERRED: Upgrade to Bundler &gt;= 2.7.0, which uses a constant timestamp for gem builds,
</span><span class='tstring_content'>             making SOURCE_DATE_EPOCH unnecessary for reproducible checksums.
</span><span class='tstring_content'>  
</span><span class='tstring_content'>  IMPORTANT: If you choose to set the build time via SOURCE_DATE_EPOCH,
</span><span class='tstring_content'>             you must re-build the gem, i.e. `bundle exec rake build` or `gem build`.
</span><span class='tstring_content'>  
</span><span class='tstring_content'>  How to set the build time (only needed for Bundler &lt; 2.7.0):
</span><span class='tstring_content'>  
</span><span class='tstring_content'>  In zsh shell:
</span><span class='tstring_content'>    - export SOURCE_DATE_EPOCH=$EPOCHSECONDS &amp;&amp; echo $SOURCE_DATE_EPOCH
</span><span class='tstring_content'>    - If the echo above has no output, then it didn&#39;t work.
</span><span class='tstring_content'>    - Note that you&#39;ll need the `zsh/datetime` module enabled.
</span><span class='tstring_content'>  
</span><span class='tstring_content'>  In fish shell:
</span><span class='tstring_content'>    - set -x SOURCE_DATE_EPOCH (date +%s)
</span><span class='tstring_content'>    - echo $SOURCE_DATE_EPOCH
</span><span class='tstring_content'>  
</span><span class='tstring_content'>  In bash shell:
</span><span class='tstring_content'>    - export SOURCE_DATE_EPOCH=$(date +%s) &amp;&amp; echo $SOURCE_DATE_EPOCH
</span><span class='tstring_content'>  
</span><span class='heredoc_end'>BUILD_TIME_WARNING</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate-class_method" title="generate (class method)">.<strong>generate</strong>(git_dry_run: false)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Script, stolen from myself, from https://github.com/rubygems/guides/pull/325 NOTE (Bundler &lt; 2.7.0): SOURCE_DATE_EPOCH must be set in your environment prior to building the gem.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#install_tasks-class_method" title="install_tasks (class method)">.<strong>install_tasks</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Make this gem’s rake tasks available in your Rakefile:.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="generate-class_method">
  
    .<strong>generate</strong>(git_dry_run: false)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Script, stolen from myself, from https://github.com/rubygems/guides/pull/325<br />
NOTE (Bundler &lt; 2.7.0): SOURCE_DATE_EPOCH must be set in your environment prior to building the gem.<br />
      Bundler &gt;= 2.7.0 uses a constant timestamp internally, so SOURCE_DATE_EPOCH is no longer required.<br />
      This ensures that the gem build, and the gem checksum will use the same timestamp,<br />
      and thus will match the SHA-256 checksum generated for every gem on Rubygems.org.<br />
Generate SHA-256 and SHA-512 checksums for a built .gem and commit them.</p>

<p>Behavior regarding reproducible builds depends on Bundler version:</p>
<ul>
  <li>Bundler &gt;= 2.7.0: SOURCE_DATE_EPOCH is not required; Bundler uses a constant timestamp.</li>
  <li>Bundler &lt; 2.7.0: you must set SOURCE_DATE_EPOCH, or upgrade Bundler. If<br />
GEM_CHECKSUMS_ASSUME_YES=true is set, the check proceeds non-interactively, but<br />
SOURCE_DATE_EPOCH is still required.</li>
</ul>

<p>The generated checksum files are written to the directory configured via<br />
GEM_CHECKSUMS_CHECKSUMS_DIR (default: “checksums”). By default, the newest .gem in<br />
GEM_CHECKSUMS_PACKAGE_DIR (default: “pkg”) is used, unless a specific .gem path is<br />
passed as the first CLI argument when running under Rake or the gem_checksums CLI.</p>

<p>By default this command will exec a <code>git add &amp;&amp; git commit</code> to include the checksum<br />
files. When <code>git_dry_run</code> is true, or GEM_CHECKSUMS_GIT_DRY_RUN=true, a dry-run commit<br />
is performed, and temporary files are cleaned up.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>git_dry_run</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>when true, perform a dry-run and do not leave files staged</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gem_checksums.rb', line 89</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span><span class='label'>git_dry_run:</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_git_dry_run_flag'>git_dry_run_flag</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_git_dry_run'>git_dry_run</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="#GIT_DRY_RUN_ENV-constant" title="GemChecksums::GIT_DRY_RUN_ENV (constant)">GIT_DRY_RUN_ENV</a></span></span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--dry-run</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Will run git commit with --dry-run</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_git_dry_run_flag'>git_dry_run_flag</span>

  <span class='comment'># Header: identify the gem and version being run
</span>  <span class='kw'>begin</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[ stone_checksums </span><span class='embexpr_beg'>#{</span><span class='op'>::</span><span class='const'><span class='object_link'><a href="StoneChecksums.html" title="StoneChecksums (module)">StoneChecksums</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="StoneChecksums/Version.html" title="StoneChecksums::Version (module)">Version</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="StoneChecksums/Version.html#VERSION-constant" title="StoneChecksums::Version::VERSION (constant)">VERSION</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'> ]</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span>
    <span class='comment'># If for any reason the version constant isn&#39;t available, skip header gracefully
</span>  <span class='kw'>end</span>

  <span class='comment'># Bundler version gate for reproducibility requirements
</span>  <span class='id identifier rubyid_bundler_ver'>bundler_ver</span> <span class='op'>=</span> <span class='kw'>begin</span>
    <span class='lparen'>(</span><span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>Bundler</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='const'>Bundler</span><span class='op'>::</span><span class='const'>VERSION</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Version</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>Bundler</span><span class='op'>::</span><span class='const'>VERSION</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='kw'>nil</span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_requires_epoch'>requires_epoch</span> <span class='op'>=</span> <span class='id identifier rubyid_bundler_ver'>bundler_ver</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_bundler_ver'>bundler_ver</span> <span class='op'>&lt;</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Version</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2.7.0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_requires_epoch'>requires_epoch</span>
    <span class='comment'># For older bundler, ask the user whether to proceed, or quit to update.
</span>    <span class='id identifier rubyid_proceed'>proceed</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GEM_CHECKSUMS_ASSUME_YES</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_casecmp'>casecmp</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>true</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_proceed'>proceed</span>
      <span class='comment'># Non-interactive prompt: advise and abort
</span>      <span class='id identifier rubyid_prompt_msg'>prompt_msg</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;~PROMPT</span>
<span class='tstring_content'>        Detected Bundler </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_bundler_ver'>bundler_ver</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(unknown)</span><span class='tstring_end'>&quot;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'> which is older than 2.7.0.
</span><span class='tstring_content'>        For reproducible builds without SOURCE_DATE_EPOCH, please update Bundler to &gt;= 2.7.0.
</span><span class='tstring_content'>        If you still want to proceed with this older Bundler, you must set SOURCE_DATE_EPOCH and re-run.
</span><span class='tstring_content'>        Tip: set GEM_CHECKSUMS_ASSUME_YES=true to proceed non-interactively (still requires SOURCE_DATE_EPOCH).
</span><span class='heredoc_end'>      PROMPT
</span>      <span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='id identifier rubyid_prompt_msg'>prompt_msg</span><span class='rparen'>)</span>
      <span class='comment'># Continue to enforce SOURCE_DATE_EPOCH below; if not set, this will raise.
</span>    <span class='kw'>end</span>

    <span class='id identifier rubyid_build_time'>build_time</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOURCE_DATE_EPOCH</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_build_time_missing'>build_time_missing</span> <span class='op'>=</span> <span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_build_time'>build_time</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\d{10,}</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_build_time_missing'>build_time_missing</span>
      <span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#BUILD_TIME_WARNING-constant" title="GemChecksums::BUILD_TIME_WARNING (constant)">BUILD_TIME_WARNING</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="GemChecksums/Error.html" title="GemChecksums::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="#BUILD_TIME_ERROR_MESSAGE-constant" title="GemChecksums::BUILD_TIME_ERROR_MESSAGE (constant)">BUILD_TIME_ERROR_MESSAGE</a></span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_gem_path_parts'>gem_path_parts</span> <span class='op'>=</span>
    <span class='kw'>case</span> <span class='const'><span class='object_link'><a href="#RUNNING_AS-constant" title="GemChecksums::RUNNING_AS (constant)">RUNNING_AS</a></span></span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rake</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gem_checksums</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_first_arg'>first_arg</span> <span class='op'>=</span> <span class='const'>ARGV</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='id identifier rubyid_first_arg'>first_arg</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:split</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_first_arg'>first_arg</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>else</span> <span class='comment'># e.g. &quot;rspec&quot;
</span>      <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_gem_path_parts'>gem_path_parts</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_gem_name'>gem_name</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_path_parts'>gem_path_parts</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
    <span class='id identifier rubyid_gem_pkg'>gem_pkg</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_path_parts'>gem_path_parts</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Looking for: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_pkg'>gem_pkg</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_gems'>gems</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_pkg'>gem_pkg</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="GemChecksums/Error.html" title="GemChecksums::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to find gem </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_pkg'>gem_pkg</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Found: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_gem_pkgs'>gem_pkgs</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#PACKAGE_DIR-constant" title="GemChecksums::PACKAGE_DIR (constant)">PACKAGE_DIR</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*.gem</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Looking for: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_pkgs'>gem_pkgs</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_gems'>gems</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='lbracket'>[</span><span class='id identifier rubyid_gem_pkgs'>gem_pkgs</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="GemChecksums/Error.html" title="GemChecksums::Error (class)">Error</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to find gems </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_pkgs'>gem_pkgs</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='comment'># Sort by newest last
</span>    <span class='comment'># [ &quot;my_gem-2.3.9.gem&quot;, &quot;my_gem-2.3.11.pre.alpha.4.gem&quot;, &quot;my_gem-2.3.15.gem&quot;, ... ]
</span>    <span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_sort_by!'>sort_by!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_gem'>gem</span><span class='op'>|</span> <span class='const'>Gem</span><span class='op'>::</span><span class='const'>Version</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_gem'>gem</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#VERSION_REGEX-constant" title="GemChecksums::VERSION_REGEX (constant)">VERSION_REGEX</a></span></span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_gem_pkg'>gem_pkg</span> <span class='op'>=</span> <span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
    <span class='id identifier rubyid_gem_path_parts'>gem_path_parts</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_pkg'>gem_pkg</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_gem_name'>gem_name</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_path_parts'>gem_path_parts</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Found: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gems'>gems</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> gems; latest is </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_pkg_bits'>pkg_bits</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_gem_pkg'>gem_pkg</span><span class='rparen'>)</span>

  <span class='comment'># SHA-512 digest is 8 64-bit words
</span>  <span class='id identifier rubyid_digest512_64bit'>digest512_64bit</span> <span class='op'>=</span> <span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA512</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_hexdigest'>hexdigest</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg_bits'>pkg_bits</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_digest512_64bit_path'>digest512_64bit_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#CHECKSUMS_DIR-constant" title="GemChecksums::CHECKSUMS_DIR (constant)">CHECKSUMS_DIR</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.sha512</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_mkdir'>mkdir</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#CHECKSUMS_DIR-constant" title="GemChecksums::CHECKSUMS_DIR (constant)">CHECKSUMS_DIR</a></span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#CHECKSUMS_DIR-constant" title="GemChecksums::CHECKSUMS_DIR (constant)">CHECKSUMS_DIR</a></span></span><span class='rparen'>)</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_digest512_64bit_path'>digest512_64bit_path</span><span class='comma'>,</span> <span class='id identifier rubyid_digest512_64bit'>digest512_64bit</span><span class='rparen'>)</span>

  <span class='comment'># SHA-256 digest is 8 32-bit words
</span>  <span class='id identifier rubyid_digest256_32bit'>digest256_32bit</span> <span class='op'>=</span> <span class='const'>Digest</span><span class='op'>::</span><span class='const'>SHA256</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_hexdigest'>hexdigest</span><span class='lparen'>(</span><span class='id identifier rubyid_pkg_bits'>pkg_bits</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_digest256_32bit_path'>digest256_32bit_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#CHECKSUMS_DIR-constant" title="GemChecksums::CHECKSUMS_DIR (constant)">CHECKSUMS_DIR</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.sha256</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_digest256_32bit_path'>digest256_32bit_path</span><span class='comma'>,</span> <span class='id identifier rubyid_digest256_32bit'>digest256_32bit</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_gem_name'>gem_name</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#VERSION_REGEX-constant" title="GemChecksums::VERSION_REGEX (constant)">VERSION_REGEX</a></span></span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_git_cmd'>git_cmd</span> <span class='op'>=</span> <span class='heredoc_beg'>&lt;&lt;~GIT_MSG</span><span class='period'>.</span><span class='id identifier rubyid_rstrip'>rstrip</span>
<span class='tstring_content'>    git add </span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#CHECKSUMS_DIR-constant" title="GemChecksums::CHECKSUMS_DIR (constant)">CHECKSUMS_DIR</a></span></span><span class='embexpr_end'>}</span><span class='tstring_content'>/* &amp;&amp; \
</span><span class='tstring_content'>    git commit </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_git_dry_run_flag'>git_dry_run_flag</span><span class='embexpr_end'>}</span><span class='tstring_content'> -m &quot;🔒️ Checksums for v</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_version'>version</span><span class='embexpr_end'>}</span><span class='tstring_content'>&quot;
</span><span class='heredoc_end'>  GIT_MSG
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_git_dry_run_flag'>git_dry_run_flag</span>
    <span class='id identifier rubyid_git_cmd'>git_cmd</span> <span class='op'>+=</span> <span class='heredoc_beg'>&lt;&lt;~CLEANUP_MSG</span>
<span class='tstring_content'>       &amp;&amp; \
</span><span class='tstring_content'>      echo &quot;Cleaning up in dry run mode&quot; &amp;&amp; \
</span><span class='tstring_content'>      git reset </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest512_64bit_path'>digest512_64bit_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> &amp;&amp; \
</span><span class='tstring_content'>      git reset </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest256_32bit_path'>digest256_32bit_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> &amp;&amp; \
</span><span class='tstring_content'>      rm -f </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest512_64bit_path'>digest512_64bit_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> &amp;&amp; \
</span><span class='tstring_content'>      rm -f </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest256_32bit_path'>digest256_32bit_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>
</span><span class='heredoc_end'>    CLEANUP_MSG
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='heredoc_beg'>&lt;&lt;~RESULTS</span>
<span class='tstring_content'>    [ GEM: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_name'>gem_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]
</span><span class='tstring_content'>    [ VERSION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_version'>version</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]
</span><span class='tstring_content'>    [ GEM PKG LOCATION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gem_pkg'>gem_pkg</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]
</span><span class='tstring_content'>    [ CHECKSUM SHA-256: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest256_32bit'>digest256_32bit</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]
</span><span class='tstring_content'>    [ CHECKSUM SHA-512: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest512_64bit'>digest512_64bit</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]
</span><span class='tstring_content'>    [ CHECKSUM SHA-256 PATH: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest256_32bit_path'>digest256_32bit_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]
</span><span class='tstring_content'>    [ CHECKSUM SHA-512 PATH: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_digest512_64bit_path'>digest512_64bit_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> ]
</span><span class='tstring_content'>    
</span><span class='tstring_content'>    ... Running ...
</span><span class='tstring_content'>    
</span><span class='tstring_content'>    </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_git_cmd'>git_cmd</span><span class='embexpr_end'>}</span><span class='tstring_content'>
</span><span class='heredoc_end'>  RESULTS
</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_git_dry_run_flag'>git_dry_run_flag</span>
    <span class='backtick'>%x{</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_git_cmd'>git_cmd</span><span class='embexpr_end'>}</span><span class='tstring_end'>}</span></span>
  <span class='kw'>else</span>
    <span class='comment'># `exec` will replace the current process with the git process, and exit.
</span>    <span class='comment'># Within the generate method, Ruby code placed after the `exec` *will not be run*:
</span>    <span class='comment'>#   See: https://www.akshaykhot.com/call-shell-commands-in-ruby
</span>    <span class='comment'># But we can&#39;t exit the process when testing from RSpec,
</span>    <span class='comment'>#   since that would exit the parent RSpec process
</span>    <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='id identifier rubyid_git_cmd'>git_cmd</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="install_tasks-class_method">
  
    .<strong>install_tasks</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Make this gem’s rake tasks available in your Rakefile:</p>

<p>require “gem_checksums”</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/gem_checksums.rb', line 60</span>

<span class='kw'>def</span> <span class='id identifier rubyid_install_tasks'>install_tasks</span>
  <span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gem_checksums/tasks.rb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Aug 26 13:36:24 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.5).
</div>

    </div>
  </body>
</html>